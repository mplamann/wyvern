module identity

import wyvern.ast
import wyvern.Int
import wyvern.option
import metadata wyvern.collections.list

type AST = ast.AST

type IntExpr
  def eval() : Int
  metadata new
    def parseTSL(input : String, ctx : system.Context) : option.Option
      val inputAST : AST = ast.parseExpression(ast.stripLeadingWhitespace(input), ctx)
      val evalDefn = ast.defn("eval", ast.types.int(), inputAST)
      val l = list.make()
      l.append(evalDefn)
      option.Some(ast.object(l))
      // TODO: Using list TSL here triggers error because metadata is not interpreted or something
      // option.Some(ast.object({evalDefn}))